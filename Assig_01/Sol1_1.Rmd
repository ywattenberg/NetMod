---
title: "Assignment 1"
author: "Huang Yingshan, Kahlbacher Fabian, Wattenberg Yannick, Aggeler Samuel"
date: "10/17/2021"
output: html_document
---

# Task 1
## 1)
The probability for observing a tie is equal to the amount of present ties divided by the number of total possible ties.
Let n = \# of dyads then:
$p = \frac{\# \text{of ties}}{\# \text{of possible ties}} = \frac{m}{n \cdot (n-1)} = \frac{174}{1190} \approx 0.146$


## 2)
The probability of observing a specific type of dyad (mutual, asymmetric and null) is the number of dyads of that type divided by the number of total possible dyads.
Let $T = {n \choose 2} = \# \text{of dyads}$

$p_M = \frac{M}{T} = \frac{52}{595} \approx 0.087$
$p_A = \frac{A}{T} = \frac{70}{595} \approx 0.118$
$p_N = \frac{N}{T} = \frac{473}{595} \approx 0.795$

## 3)
Assuming tie independence with $p = 0.146$ as the probability that a tie exists we get the following values:
$p_M' = P[x_{ij} = 1 \cap x_{ji} = 1] \stackrel{\text{tie ind}.}{=} P[x_{ij} = 1] \cdot P[x_{ji} = 1] = p^2 \approx 0.021$
$p_A' = P[x_{ij} = 1 \cap x_{ji} = 0] + P[x_{ij} = 0 \cap x_{ji} = 1]  \stackrel{\text{tie ind}.}{=}  2 \cdot P[x_{ij} = 1] \cdot P[x_{ji} = 0] = 2 \cdot p \cdot (1-p) \approx 0.25$
$p_N' = P[x_{ij} = 0 \cap x_{ji} = 0] \stackrel{\text{tie ind}.}{=} P[x_{ij} = 0] \cdot P[x_{ji} = 0] = (1 - p)^2 \approx 0.729$

## 4)
The probability of observing mutual dyads in the network is four times higher than what we would expect with tie independence. Further the probability of observing asymmetric dyads
is more than two times higher when assuming tie independence, for null dyads the probability of observation is 6.6\% lower when assuming tie independence.
Given the differences in probability for mutual and asymmetric dyads we would argue that assuming tie independence would not be reasonable.

```{r setup, include=FALSE}

set.seed(1908)
library(sna)
library(network)
obsMat <- as.matrix(read.csv("matrix.csv"))
cguRec1 <- cug.test(obsMat, grecip, cmode = "edges", reps = 3000)
cguRec2 <- cug.test(obsMat, grecip, cmode = "dyad.census", reps = 3000)
cugTrans <- cug.test(obsMat, gtrans, cmode = "dyad.census",  reps = 3000)
cguRec1
cguRec2
cugTrans



```




# Task 1
## 1) /( /frac{174}{35*34) /)


# Task 2

```{r}
set.seed(1908)
permutations <- 5000
trade2006 <- as.matrix(read.csv("trade1.csv", header=FALSE))
trade2007 <- as.matrix(read.csv("trade2.csv", header=FALSE))
attr <- read.csv("attr.csv")
nl0 <- netlm(trade2007, trade2006, rep=permutations, nullhyp="qapy")
summary(nl0)

##### 2

sector <- attr[,2]
sameSector <- outer(sector,sector,"==")*1
diag(sameSector) <- FALSE

SectorSender <- matrix(sector,18,18,byrow=FALSE) # Hp. 2

zm <- list(SectorSender, sameSector)
nl <- netlm(trade2007, zm, rep=permutations, nullhyp="qapspp")
nl$names <- c("intercept", "sameSector", "SectorSender")
```
